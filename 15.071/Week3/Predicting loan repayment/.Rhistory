rm(list = ls())
setwd("/home/musigma/MOOC/15.071/Week3/Predicting loan repayment/")
loans <- read.csv("loans.csv", header = T, stringsAsFactors = F)
table(loans$not.fully.paid)
table(loans$not.fully.paid)[0]
table(loans$not.fully.paid)[1]
table(loans$not.fully.paid)[2]
1533/(8045+1533)
str(loans)
summary(loans)
install.packages('mice')
library(mice)
set.seed(144)
vars.for.imputation = setdiff(names(loans), "not.fully.paid")
rm(list = ls())
setwd("/home/musigma/MOOC/15.071/Week3/Predicting loan repayment/")
loans <- read.csv("loans.csv", header = T, stringsAsFactors = F)
# Problem 1.1 - Preparing the Dataset
table(loans$not.fully.paid)
1533/(8045+1533)
# Problem 1.2 - Preparing the Dataset
summary(loans)
# Problem 1.4 - Preparing the Dataset
library(mice)
set.seed(144)
vars.for.imputation = setdiff(names(loans), "not.fully.paid")
imputed = complete(mice(loans[vars.for.imputation]))
loans[vars.for.imputation] = imputed
split <- sample.split(loans$not.fully.paid, SplitRatio = 0.7)
set.seed(144)
split <- sample.split(loans$not.fully.paid, SplitRatio = 0.7)
library(caTools)
set.seed(144)
split <- sample.split(loans$not.fully.paid, SplitRatio = 0.7)
set.seed(144)
library(caTools)
split <- sample.split(loans$not.fully.paid, SplitRatio = 0.7)
train <- subset(loans, split = TRUE)
test <- subset(loans, split = FALSE)
LoanModel1 <- glm(not.fully.paid~., data = train, family = binomial)
summary(LoanModel1)
-8.951e-03 * 10
exp(8.951e-03 * 10)
log(1.093638)
-9.317e-03 * (700-710)
exp(-9.317e-03 * (700-710))
rm(list = ls())
setwd("/home/musigma/MOOC/15.071/Week3/Predicting loan repayment/")
loans <- read.csv("loans.csv", header = T, stringsAsFactors = F)
library(mice)
set.seed(144)
vars.for.imputation = setdiff(names(loans), "not.fully.paid")
imputed = complete(mice(loans[vars.for.imputation]))
loans[vars.for.imputation] = imputed
library(caTools)
set.seed(144)
split <- sample.split(loans$not.fully.paid, SplitRatio = 0.7)
train <- subset(loans, split = TRUE)
test <- subset(loans, split = FALSE)
LoanModel1 <- glm(not.fully.paid~., data = train, family = binomial)
summary(LoanModel1)
loans <- read.csv("loans_imputed.csv", header = T, stringsAsFactors = F)
# Problem 2.1 - Prediction Models
library(caTools)
set.seed(144)
split <- sample.split(loans$not.fully.paid, SplitRatio = 0.7)
train <- subset(loans, split = TRUE)
test <- subset(loans, split = FALSE)
LoanModel1 <- glm(not.fully.paid~., data = train, family = binomial)
summary(LoanModel1)
rm(list = ls())
setwd("/home/musigma/MOOC/15.071/Week3/Predicting loan repayment/")
loans <- read.csv("loans.csv", header = T, stringsAsFactors = F)
# Problem 1.1 - Preparing the Dataset
table(loans$not.fully.paid)
rm(list = ls())
setwd("/home/musigma/MOOC/15.071/Week3/Predicting loan repayment/")
loans <- read.csv("loans_imputed.csv", header = T, stringsAsFactors = F)
library(caTools)
set.seed(144)
split <- sample.split(loans$not.fully.paid, SplitRatio = 0.7)
train <- subset(loans, split = TRUE)
test <- subset(loans, split = FALSE)
LoanModel1 <- glm(not.fully.paid~., data = train, family = binomial)
summary(LoanModel1)
rm(list = ls())
setwd("/home/musigma/MOOC/15.071/Week3/Predicting loan repayment/")
loans <- read.csv("loans_imputed.csv", header = T, stringsAsFactors = F)
# Problem 2.1 - Prediction Models
library(caTools)
set.seed(144)
split = sample.split(loans$not.fully.paid, SplitRatio=0.7)
train = subset(loans, split==TRUE)
test = subset(loans, split==FALSE)
LoanModel1 = glm(not.fully.paid~., data=train, family="binomial")
summary(LoanModel1)
summary(LoanModel1)
predicted.risk <- predict(LoanModel1, newdata = test, type = "response")
test$not.fully.paid.predicted <- predicted.risk
table(test$not.fully.paid, predicted.risk >= 0.5)
(2400+3)/(2400+3+13+457)
2857/nrow(test)
2857/(2857+13+3)
(2400+13)/(2400+13+457+3)
library(ROCR)
ROCRpred <- prediction(predicted.risk, test$not.fully.paid)
as.numeric(performance(ROCRpred, "auc")@y.values)
View(loans)
LoanModel2 = glm(not.fully.paid~init.rate, data=train, family="binomial")
summary(LoanModel2)
View(train)
LoanModel2 = glm(not.fully.paid~int.rate, data=train, family="binomial")
summary(LoanModel2)
predict(LoanModel2, newdata = test, type = binomial)
predict(LoanModel2, newdata = test, type = "response")
predicted.risk_binomial <- predict(LoanModel2, newdata = test, type = "response")
max(predicted.risk_binomial)
table(test$not.fully.paid, predicted.risk_binomial >= 0.5)
2413+460
table(predicted.risk_binomial>=0.5)
10*exp(0.18)
test$profit = exp(test$int.rate*3) - 1
test$profit[test$not.fully.paid == 1] = -1
max(test$profit)
View(test)
highInterest <- subset(test, int.rate >= 0.15)
mean(highInterest$profit)
table(highInterest$not.fully.paid)
110/(437)
View(test)
cutoff = sort(highInterest$not.fully.paid.predicted, decreasing=FALSE)[100]
selectedLoans <- subset(test, test$not.fully.paid.predicted >= cutoff)
selectedLoans <- subset(test, test$not.fully.paid.predicted <= cutoff)
selectedLoans <- subset(test, test$not.fully.paid.predicted >= cutoff)
selectedLoans <- subset(test, test$not.fully.paid.predicted > cutoff)
View(selectedLoans)
nrow(selectedLoans)
selectedLoans <- subset(test, test$not.fully.paid.predicted < cutoff)
selectedLoans <- subset(highInterest, not.fully.paid.predicted < cutoff)
selectedLoans <- subset(highInterest, not.fully.paid.predicted <= cutoff)
mean(highInterest$profit)
table(highInterest$not.fully.paid)
mean(selectedLoans$profit)
table(selectedLoans$not.fully.paid)
sum(selectedLoans$profit)
